Created: 2024-04-14 - 04:24


# Summary
## Information
1. Name: unknown.exe.malz
2. SHA256:  3ACA2A08CF296F1845D6171958EF0FFD1C8BDFC3E48BDD34A605CB1F7468213E
3. Compiler Timestamp: Sat Jan 08 21:29:18 2022 | UTC
4. CPU: 64-bit

## Behavior
1. 


# Static Analysis

## Interesting Strings

```bash
@http://cdn.altimiter.local/feed?post=
@Nim httpclient/1.6.2
@Desktop\\cosmo.jpeg
@SikoMode
@Mozilla/5.0
@C:\\Users\\Public\\passwrd.txt
ascii,85,overlay,-,-,-,-,NTIprocLs58stream_line58varstringT58boolLOnimcall_gcsafeOT__7jFfqMk9ajToCz6Hv9atCA4A_
homeDir__sikomode_13
houdini__sikomode_51
stealStuff__sikomode_130
getContent__sikomode_194
ds_open_handle__sikomode_53
request__sikomode_208
unpackResources__sikomode_17
checkKillSwitchURL__sikomode_25
httpError__pureZhttpclient_202
murmurHash__pureZhashes_192
hash__pureZhashes_279

```


## Interesting Imports

```
GetCurrentProcessId
VirtualAlloc
VirtualProtect
GetCurrentProcess
GetCurrentThreadId
RtlAddFunctionTable
RtlLookupFunctionEntry
TerminateProcess
LoadLibraryA
GetProcAddress
```

## Section

![](attachments/Pasted%20image%2020240414050605.png)



## Decompilation

### Interesting stuff
1. ![](attachments/Pasted%20image%2020240414100837.png)
	1. Seems like it might read this file in code to extract the password and use that to possible decrypt something else.

# Dynamic Analysis
2. ![](attachments/Pasted%20image%2020240415092017.png)
	1. Breakpoint on VirtualAlloca triggered and the newly allocated memory seems to have been populated with the unpacked malware
	2. Has reference to the `Cosmo.jpeg` file and the `paswrd.txt` file
3. ![](attachments/Pasted%20image%2020240415092437.png)
	1. Found a URL in the unpacked / decrypted section
	2. `http://update.ec12-4-109-278`
4. ![](attachments/Pasted%20image%2020240415095344.png)
5. ![](attachments/Pasted%20image%2020240415095420.png)
6. 


# Challenge Questions:

- What language is the binary written in?
	- NIM
- What is the architecture of this binary?
	- x86_64
- Under what conditions can you get the binary to delete itself?
	- When it can't access the einternet
- Does the binary persist? If so, how?
	- No evidence found of persistence
- What is the first callback domain?
	- update.ec12-4-109-278-3-ubuntu20-04.local
- Under what conditions can you get the binary to exfiltrate data?
- What is the exfiltration domain?
	- cdn.altimeter.local
- How does exfiltration take place?
- What URI is used to exfiltrate data?
- What type of data is exfiltrated (the file is cosmo.jpeg, but how exactly is the file's data transmitted?)
- What kind of encryption algorithm is in use?
- What key is used to encrypt the data?
- What is the significance of `houdini`?